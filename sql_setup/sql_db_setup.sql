CREATE DATABASE refinance;

\connect refinance;

CREATE TABLE ma_refinance (
	activity_year int4 NULL,
	lei varchar(1024) NULL,
	"derived_msa-md" int4 NULL,
	state_code varchar(1024) NULL,
	county_code int4 NULL,
	census_tract float4 NULL,
	conforming_loan_limit varchar(1024) NULL,
	derived_loan_product_type varchar(1024) NULL,
	derived_dwelling_category varchar(1024) NULL,
	derived_ethnicity varchar(1024) NULL,
	derived_race varchar(1024) NULL,
	derived_sex varchar(1024) NULL,
	action_taken int4 NULL,
	purchaser_type int4 NULL,
	preapproval int4 NULL,
	loan_type int4 NULL,
	loan_purpose int4 NULL,
	lien_status int4 NULL,
	reverse_mortgage int4 NULL,
	"open-end_line_of_credit" int4 NULL,
	business_or_commercial_purpose int4 NULL,
	loan_amount float4 NULL,
	loan_to_value_ratio varchar(1024) NULL,
	interest_rate varchar(1024) NULL,
	rate_spread varchar(1024) NULL,
	hoepa_status int4 NULL,
	total_loan_costs varchar(1024) NULL,
	total_points_and_fees varchar(1024) NULL,
	origination_charges varchar(1024) NULL,
	discount_points varchar(1024) NULL,
	lender_credits varchar(1024) NULL,
	loan_term int4 NULL,
	prepayment_penalty_term varchar(1024) NULL,
	intro_rate_period varchar(1024) NULL,
	negative_amortization int4 NULL,
	interest_only_payment int4 NULL,
	balloon_payment int4 NULL,
	other_nonamortizing_features int4 NULL,
	property_value varchar(1024) NULL,
	construction_method int4 NULL,
	occupancy_type int4 NULL,
	manufactured_home_secured_property_type int4 NULL,
	manufactured_home_land_property_interest int4 NULL,
	total_units int4 NULL,
	multifamily_affordable_units varchar(1024) NULL,
	income varchar(1024) NULL,
	debt_to_income_ratio varchar(1024) NULL,
	applicant_credit_score_type int4 NULL,
	"co-applicant_credit_score_type" int4 NULL,
	"applicant_ethnicity-1" int4 NULL,
	"applicant_ethnicity-2" int4 NULL,
	"applicant_ethnicity-3" varchar(1024) NULL,
	"applicant_ethnicity-4" varchar(1024) NULL,
	"applicant_ethnicity-5" varchar(1024) NULL,
	"co-applicant_ethnicity-1" int4 NULL,
	"co-applicant_ethnicity-2" int4 NULL,
	"co-applicant_ethnicity-3" varchar(1024) NULL,
	"co-applicant_ethnicity-4" varchar(1024) NULL,
	"co-applicant_ethnicity-5" varchar(1024) NULL,
	applicant_ethnicity_observed int4 NULL,
	"co-applicant_ethnicity_observed" int4 NULL,
	"applicant_race-1" int4 NULL,
	"applicant_race-2" int4 NULL,
	"applicant_race-3" int4 NULL,
	"applicant_race-4" varchar(1024) NULL,
	"applicant_race-5" varchar(1024) NULL,
	"co-applicant_race-1" int4 NULL,
	"co-applicant_race-2" int4 NULL,
	"co-applicant_race-3" int4 NULL,
	"co-applicant_race-4" varchar(1024) NULL,
	"co-applicant_race-5" varchar(1024) NULL,
	applicant_race_observed int4 NULL,
	"co-applicant_race_observed" int4 NULL,
	applicant_sex int4 NULL,
	"co-applicant_sex" int4 NULL,
	applicant_sex_observed int4 NULL,
	"co-applicant_sex_observed" int4 NULL,
	applicant_age varchar(1024) NULL,
	"co-applicant_age" varchar(1024) NULL,
	applicant_age_above_62 varchar(1024) NULL,
	"co-applicant_age_above_62" varchar(1024) NULL,
	submission_of_application int4 NULL,
	initially_payable_to_institution int4 NULL,
	"aus-1" int4 NULL,
	"aus-2" int4 NULL,
	"aus-3" varchar(1024) NULL,
	"aus-4" varchar(1024) NULL,
	"aus-5" varchar(1024) NULL,
	"denial_reason-1" int4 NULL,
	"denial_reason-2" int4 NULL,
	"denial_reason-3" int4 NULL,
	"denial_reason-4" int4 NULL,
	tract_population int4 NULL,
	tract_minority_population_percent float4 NULL,
	ffiec_msa_md_median_family_income int4 NULL,
	tract_to_msa_income_percentage int4 NULL,
	tract_owner_occupied_units int4 NULL,
	tract_one_to_four_family_homes int4 NULL,
	tract_median_age_of_housing_units int4 NULL
);

\copy ma_refinance FROM '../data/actions_taken_1-2-3_boa_loan_purposes_31_ma.csv' DELIMITER ',' CSV HEADER;